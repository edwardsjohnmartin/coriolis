<!DOCTYPE html>
<html>
  <head>
  
  <!------------------------------------------------------------>
  <!------------------------ Line shaders ---------------------->
  <!------------------------------------------------------------>

  <script id="line-vshader" type="x-shader/x-vertex">
    
    attribute vec4 vPosition;
    attribute vec4 vColor;
    varying vec4 fColor;
    
    uniform mat4 mvMatrix;
    uniform mat4 pMatrix;
    
    void main() {
      gl_Position = pMatrix*mvMatrix*vPosition;
      fColor = vColor;
    } 
  </script>
  
  <script id="line-fshader" type="x-shader/x-fragment">
    
    #ifdef GL_ES
    precision highp float;
    #endif
    
    varying vec4 fColor;
    
    void main() {
      gl_FragColor = fColor;
    }
  </script>
  
  <!------------------------------------------------------------>
  <!------------------- Flat Line shaders ---------------------->
  <!------------------------------------------------------------>

  <script id="flat-line-vshader" type="x-shader/x-vertex">
    
    attribute vec4 vPosition;
    varying vec4 fColor;
    
    uniform vec4 lookAt;
    uniform vec4 uColor;
    uniform mat4 mvMatrix;
    uniform mat4 pMatrix;
    uniform mat4 rotMatrix;
    uniform float depthOffset;
    uniform float grayOutFactor;
    
    void main() {
      vec4 temp = mvMatrix*vPosition;
      gl_Position = pMatrix*mvMatrix*vPosition;
      fColor = uColor;
      //if (temp.z < 0.0)
      //  fColor.x = abs(temp.z);//1.0;// = sqrt(fColor);
      //fColor.x = abs(temp.z);
 
      if (dot(normalize((rotMatrix*vPosition).xyz), vec3(0.0,0.0,1.0)) < 0.0) {
        //const float f = grayOutFactor;
        fColor = fColor + (vec4(1.0, 1.0, 1.0, 1.0) - fColor)*grayOutFactor;
      }

      gl_Position.z = gl_Position.z + depthOffset;
    } 
  </script>
  
  <script id="flat-line-fshader" type="x-shader/x-fragment">
    
    #ifdef GL_ES
    precision highp float;
    #endif
    
    varying vec4 fColor;
    
    void main() {
      gl_FragColor = fColor;
      //gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);
    }
  </script>
  
  <!------------------------------------------------------------>
  <!---------------------- Sphere shaders ---------------------->
  <!------------------------------------------------------------>

  <script id="sphere-vshader" type="x-shader/x-vertex">
    attribute vec4 vPosition;
    attribute vec4 vNormal;
    attribute vec4 vColor;
    varying vec4 fColor;
    varying highp vec3 vLighting;
    
    uniform mat4 mvMatrix;
    uniform mat4 pMatrix;
    uniform mat4 nMatrix;
    
    void main() {
      gl_Position = pMatrix*mvMatrix*vPosition;

      highp vec3 ambientColor = vec3(0.6, 0.6, 0.6);
      highp vec3 lightColor = vec3(0.5, 0.5, 0.75);
      highp vec3 lightVector = vec3(0.85, 0.8, 0.75);

      highp vec4 tNormal = nMatrix * vNormal;
      tNormal = normalize(tNormal);
      highp float directional = max(dot(tNormal.xyz, lightVector), 0.0);
      vLighting = ambientColor + (lightColor * directional);
      fColor = vColor;
    } 
  </script>

  <script id="sphere-fshader" type="x-shader/x-fragment">
    
    #ifdef GL_ES
    precision highp float;
    #endif
    
    varying vec4 fColor;
    varying highp vec3 vLighting;
    
    void main() {
      gl_FragColor = vec4(fColor.xyz * vLighting, fColor.a);
      //gl_FragColor = fColor;
    }
  </script>
  
  <script type="text/javascript" src="./common/webgl-utils.js"></script>
  <script type="text/javascript" src="./common/initShaders.js"></script>
  <script type="text/javascript" src="./common/MV.js"></script>

  <script type="text/javascript" src="arcBall.js"></script>
  <script type="text/javascript" src="axis.js"></script>
  <script type="text/javascript" src="world.js"></script>
  <script type="text/javascript" src="sphere.js"></script>
  <script type="text/javascript" src="floor.js"></script>
  <script type="text/javascript" src="segment.js"></script>
  <script type="text/javascript" src="arrow.js"></script>
  <script type="text/javascript" src="greatCircle.js"></script>

  <script type="text/javascript" src="coriolis.js"></script>
  
  </head>

  <body>
    <canvas id="gl-canvas" width="512" height="512">
      Oops ... your browser doesn't support the HTML5 canvas element
    </canvas>
    
  </body>
</html>
